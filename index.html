<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Online Whiteboard (Improved)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.1/fabric.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body class="bg-slate-100">

    <!-- Toolbar -->
    <div id="toolbar" class="toolbar justify-center">
        <!-- Main tools -->
        <div class="tool-group">
            <button id="select-tool" class="tool-btn" title="Select Tool (V)"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.042 21.672L13.684 16.6m0 0l-2.51 2.225.569-9.47 5.227 7.917-3.286-.672zm-7.518-.267A8.25 8.25 0 1120.25 10.5M8.288 14.212A5.25 5.25 0 1117.25 10.5" /></svg></button>
            <button id="pencil-tool" class="tool-btn" title="Pencil (P)"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125" /></svg></button>
            <button id="text-tool" class="tool-btn" title="Add Text (T)"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M8.828 15.172a.5.5 0 00.707 0l1.293-1.293a.5.5 0 01.707 0l1.293 1.293a.5.5 0 00.707 0l1.293-1.293a.5.5 0 01.707 0l1.293 1.293a.5.5 0 00.707 0l3.536-3.536a.5.5 0 000-.707l-3.536-3.536a.5.5 0 00-.707 0L15.172 9.172a.5.5 0 01-.707 0L13.172 7.88a.5.5 0 00-.707 0L11.172 9.17a.5.5 0 01-.707 0L9.172 7.88a.5.5 0 00-.707 0l-1.293 1.293a.5.5 0 01-.707 0l-1.293-1.293a.5.5 0 00-.707 0L3.172 9.172a.5.5 0 000 .707l3.536 3.536a.5.5 0 00.707 0l1.293-1.293z" /></svg></button>
        </div>
        
        <!-- Shape tools -->
        <div class="tool-group">
            <button id="rect-tool" class="tool-btn" title="Rectangle (R)"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 7.5A2.25 2.25 0 017.5 5.25h9a2.25 2.25 0 012.25 2.25v9a2.25 2.25 0 01-2.25 2.25h-9a2.25 2.25 0 01-2.25-2.25v-9z" /></svg></button>
            <button id="oval-tool" class="tool-btn" title="Oval (O)"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg></button>
            <button id="rounded-rect-tool" class="tool-btn" title="Rounded Rectangle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><rect x="3" y="5" width="18" height="14" rx="5" /></svg></button>
        </div>

        <!-- Drawing options -->
        <div class="tool-group">
            <label for="auto-refine" class="text-sm font-medium text-slate-700 select-none cursor-pointer" title="Automatically smoothen freehand drawing">Auto-Refine</label>
            <input type="checkbox" id="auto-refine" class="h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-600 cursor-pointer">
        </div>
        
        <!-- Contextual controls for selected objects -->
        <div id="context-controls" class="tool-group">
            <div class="color-input-wrapper" title="Fill Color">
                <div id="fill-color-swatch" class="color-swatch"></div>
                <input type="color" id="fill-color" class="color-input" value="#cccccc">
            </div>
            <div class="color-input-wrapper" title="Stroke/Text Color">
                <div id="stroke-color-swatch" class="color-swatch"></div>
                <input type="color" id="stroke-color" class="color-input" value="#333333">
            </div>
             <div class="flex items-center gap-2" title="Stroke Width">
                <svg class="w-5 h-5 text-slate-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 3.75L18 6m-3.75-2.25L12 1m4.125 5.125L12 9" /></svg>
                <input type="range" id="stroke-width-slider" min="1" max="50" step="1" value="2" class="w-24">
            </div>
            <div class="flex items-center gap-2" title="Opacity">
                <svg class="w-5 h-5 text-slate-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v18m4.243-7.757l-8.486-8.486M4.243 19.757l8.486-8.486" /></svg>
                <input type="range" id="opacity-slider" min="0" max="1" step="0.05" value="1" class="w-24">
            </div>
        </div>

        <!-- Action buttons -->
        <div class="tool-group">
             <button id="delete-tool" class="tool-btn" title="Delete Selected (Backspace)"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.134-2.033-2.134H8.033c-1.12 0-2.033.954-2.033 2.134v.916m7.5 0a48.667 48.667 0 00-7.5 0" /></svg></button>
            <button id="clear-canvas" class="tool-btn" title="Clear All"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" /></svg></button>
        </div>
    </div>

    <!-- Canvas Wrapper -->
    <div id="canvas-container-wrapper" class="canvas-container-wrapper">
        <canvas id="c"></canvas>
    </div>

    <!-- Clear Canvas Confirmation Modal -->
    <div id="clear-confirm-modal" class="modal-overlay">
        <div class="modal-content">
            <h2 class="text-xl font-semibold">Clear Canvas</h2>
            <p>Are you sure you want to clear the entire canvas? This action cannot be undone.</p>
            <div class="modal-buttons">
                <button id="modal-cancel-btn" class="modal-btn modal-btn-cancel">Cancel</button>
                <button id="modal-confirm-btn" class="modal-btn modal-btn-confirm">Clear Canvas</button>
            </div>
        </div>
    </div>
    <script src="script.js"></script>
</body>
</html>